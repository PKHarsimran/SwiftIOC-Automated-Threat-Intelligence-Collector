<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SwiftIOC Threat Intelligence Dashboard</title>
    <meta
      name="description"
      content="Live SwiftIOC threat intelligence snapshot with indicators, source breakdowns, tags, and exports."
    />
    <meta name="theme-color" content="#0f172a" />
    <meta property="og:title" content="SwiftIOC Threat Intelligence Dashboard" />
    <meta
      property="og:description"
      content="Inspect the freshest SwiftIOC indicators and source breakdowns in a compact live dashboard."
    />
    <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="assets/styles.css" />

    <style>
      /* Page-specific layout refinements for the main dashboard */

      .page-wrapper {
        min-height: 100vh;
        padding: 1.25rem 1.5rem 2.25rem;
        max-width: 1320px;
      }

      .page-header {
        padding-inline: 0.1rem;
        margin-bottom: 0.75rem;
      }

      .page-header-main {
        gap: 0.75rem;
      }

      .page-header h1 {
        margin-bottom: 0.2rem;
      }

      .page-header-subtitle {
        max-width: 36rem;
      }

      .status-banner {
        margin-bottom: 0.9rem;
      }

      .metrics-strip {
        margin-bottom: 1rem;
      }

      .dashboard-main {
        display: grid;
        grid-template-columns: minmax(0, 1.75fr) minmax(0, 1.1fr);
        gap: 0.9rem;
        align-items: stretch;
      }

      .dashboard-main .panel {
        height: 100%;
      }

      .panel-body.preview-panel {
        display: flex;
        flex-direction: column;
        gap: 0.65rem;
      }

      .preview-toolbar {
        display: flex;
        flex-wrap: wrap;
        gap: 0.55rem;
        align-items: center;
        justify-content: space-between;
      }

      .preview-toolbar .toolbar-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 0.55rem;
        align-items: center;
      }

      .preview-toolbar .toolbar-group {
        min-width: 8.5rem;
      }

      .preview-toolbar .toolbar-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.45rem;
        align-items: center;
      }

      .preview-toolbar input[type='search'] {
        min-width: 11.5rem;
      }

      .preview-table-wrapper {
        flex: 1;
        min-height: 0;
        border-radius: 0.7rem;
        border: 1px solid var(--border-soft);
        background: rgba(15, 23, 42, 0.96);
        overflow: auto;
        max-height: 60vh; /* scales with viewport height */
      }

      .preview-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.72rem;
        transition: background 0.15s ease;
      }

      .preview-table th,
      .preview-table td {
        padding: 0.35rem 0.55rem;
      }

      .preview-table thead th {
        position: sticky;
        top: 0;
        z-index: 1;
      }

      .preview-indicator {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }

      .preview-indicator-main {
        flex: 1;
        min-width: 0;
      }

      .preview-indicator-main code {
        font-size: 0.7rem;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        display: block;
        max-width: 100%;
      }

      .preview-indicator-meta {
        display: none;
        align-items: center;
        gap: 0.35rem;
        flex-wrap: wrap;
        margin-top: 0.1rem;
      }

      .preview-meta-pill {
        display: inline-flex;
        align-items: center;
        gap: 0.28rem;
        font-size: 0.62rem;
        letter-spacing: 0.01em;
        padding: 0.12rem 0.38rem;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.28);
        background: rgba(148, 163, 184, 0.12);
        color: var(--text-soft);
      }

      .preview-meta-pill.meta-type {
        background: rgba(59, 130, 246, 0.14);
        border-color: rgba(59, 130, 246, 0.35);
        color: #dbeafe;
      }

      .preview-meta-pill.meta-source {
        background: rgba(34, 197, 94, 0.12);
        border-color: rgba(34, 197, 94, 0.3);
        color: #dcfce7;
      }

      .preview-meta-pill.meta-confidence {
        background: rgba(234, 179, 8, 0.12);
        border-color: rgba(234, 179, 8, 0.3);
        color: #fef9c3;
      }

      .preview-indicator-tags {
        display: inline-flex;
        flex-wrap: wrap;
        gap: 0.2rem;
        margin-top: 0.1rem;
      }

      .preview-indicator-tags span {
        font-size: 0.6rem;
        padding: 0.04rem 0.3rem;
        border-radius: 999px;
        background: rgba(37, 99, 235, 0.12);
        color: var(--accent-soft);
      }

      .preview-indicator-copy {
        flex-shrink: 0;
      }

      .preview-indicator-copy button {
        font-size: 0.65rem;
        padding: 0.2rem 0.55rem;
      }

      .preview-summary {
        font-size: 0.7rem;
        color: var(--text-soft);
        display: flex;
        flex-wrap: wrap;
        gap: 0.35rem 0.75rem;
        align-items: center;
        justify-content: space-between;
      }

      .preview-summary-main {
        display: flex;
        flex-wrap: wrap;
        gap: 0.35rem 0.75rem;
        align-items: baseline;
      }

      .preview-summary-figure {
        font-weight: 600;
        color: var(--text-strong);
      }

      .preview-summary-pill {
        padding: 0.1rem 0.38rem;
        border-radius: 999px;
        background: rgba(148, 163, 184, 0.14);
        border: 1px solid rgba(148, 163, 184, 0.24);
      }

      .preview-summary-high {
        color: var(--accent-soft);
      }

      .preview-summary-tag {
        color: var(--accent-soft);
      }

      .preview-status {
        font-size: 0.7rem;
        color: var(--text-soft);
        margin-top: 0.25rem;
      }

      .preview-status[data-status='error'] {
        color: var(--danger-soft);
      }

      .preview-status[data-status='empty'] {
        color: var(--warning-soft);
      }

      .preview-status[data-status='loading'] {
        color: var(--accent-soft);
      }

      .summary-tables {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .summary-tables .panel-body {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .summary-tables .table-card {
        max-height: 18.5rem;
        overflow: auto;
      }

      .table-card-actions {
        margin-top: 0.35rem;
        display: none;
        flex-direction: column;
        gap: 0.35rem;
      }

      .table-card-actions .button {
        width: 100%;
        justify-content: center;
      }

      .table-card-hint {
        margin: 0;
        font-size: 0.68rem;
        color: var(--text-soft);
      }

      .exports-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .exports-grid a.button-link {
        flex: 1 1 8rem;
        justify-content: center;
      }

      @media (max-width: 1100px) {
        .dashboard-main {
          grid-template-columns: minmax(0, 1.5fr) minmax(0, 1.1fr);
        }
      }

      @media (max-width: 820px) {
        .top-nav {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.6rem;
          position: sticky;
          top: 0.6rem;
        }

        .nav-links {
          width: 100%;
          justify-content: flex-start;
          gap: 0.35rem;
          overflow-x: auto;
          padding-bottom: 0.2rem;
        }

        .nav-links a {
          padding: 0.3rem 0.6rem;
          border-radius: 999px;
          border: 1px solid rgba(148, 163, 184, 0.3);
        }
      }

      @media (max-width: 900px) {
        .dashboard-main {
          grid-template-columns: minmax(0, 1fr);
        }

        .summary-tables .table-card {
          max-height: none;
        }
      }

      @media (max-width: 760px) {
        .dashboard-main {
          gap: 0.75rem;
        }

        .preview-summary {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.4rem;
        }

        .preview-summary-meta {
          display: grid;
          width: 100%;
          gap: 0.35rem;
        }

        .preview-table-wrapper {
          max-height: none;
        }

        .preview-table {
          display: block;
        }

        .preview-table thead {
          display: none;
        }

        .preview-table tbody {
          display: grid;
          gap: 0.65rem;
        }

        .preview-table tr {
          display: grid;
          gap: 0.4rem;
          padding: 0.65rem 0.7rem;
          border-radius: 0.9rem;
          border: 1px solid var(--border-soft);
          box-shadow: 0 14px 30px rgba(15, 23, 42, 0.65);
          background: rgba(15, 23, 42, 0.98);
        }

        .preview-table tr:nth-child(2n) td,
        .preview-table tr:hover td {
          background: transparent;
        }

        .preview-indicator {
          align-items: flex-start;
          gap: 0.55rem;
        }

        .preview-indicator-meta {
          display: flex;
          width: 100%;
        }

        .preview-indicator-main code {
          white-space: normal;
          word-break: break-word;
        }

        .preview-indicator-copy button {
          width: 100%;
          justify-content: center;
        }

        .preview-table td {
          display: grid;
          grid-template-columns: minmax(5rem, 6rem) minmax(0, 1fr);
          align-items: baseline;
          gap: 0.35rem;
          padding: 0;
          border: none;
        }

        .preview-table td[data-title]::before {
          display: block;
          font-weight: 600;
          color: var(--text-soft);
          letter-spacing: 0.01em;
        }

        td.numeric {
          text-align: left;
        }

        .table-card {
          max-height: none;
        }

        .table-card-actions {
          display: flex;
        }
      }

      @media (max-width: 640px) {
        .page-wrapper {
          padding-inline: 0.9rem;
        }

        .page-header {
          padding-inline: 0;
        }

        .page-header-main {
          flex-direction: column;
          align-items: flex-start;
        }

        .preview-toolbar {
          flex-direction: column;
          align-items: stretch;
          gap: 0.4rem;
        }

        .preview-toolbar .toolbar-controls {
          width: 100%;
        }

        .preview-toolbar .toolbar-group {
          flex: 1;
        }

        .preview-toolbar .toolbar-actions {
          width: 100%;
        }

        .preview-toolbar input[type='search'] {
          flex: 1;
          min-width: 0;
        }

        .preview-table-wrapper {
          max-height: 65vh;
        }
      }

      @media (max-width: 540px) {
        .metrics-strip {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .metrics-strip .metric-card:nth-child(3),
        .metrics-strip .metric-card:nth-child(4) {
          grid-column: span 1;
        }

        .summary-tables .table-card {
          max-height: none;
        }
      }

      @media (max-width: 480px) {
        .page-wrapper {
          padding-inline: 0.75rem;
        }

        .metrics-strip {
          grid-template-columns: 1fr;
        }

        .panel-header {
          align-items: flex-start;
          gap: 0.6rem;
        }

        .panel-header-link {
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body data-ioc-root=".">
    <div class="page-wrapper">
      <nav class="top-nav" aria-label="SwiftIOC navigation">
        <a class="brand" href="index.html">
          <span class="brand-mark">SwiftIOC</span>
          <span class="brand-tagline">Threat Intelligence</span>
        </a>
        <div class="nav-links">
          <a href="#live-preview">Live snapshot</a>
          <a href="#sources">Sources</a>
          <a href="#indicator-types">Types</a>
          <a href="#tags">Tags</a>
          <a href="diagnostics/summary.html">Run diagnostics</a>
        </div>
      </nav>

      <header class="page-header">
        <div class="page-header-main">
          <div>
            <h1 class="section-title">SwiftIOC IOC Snapshot</h1>
            <p class="page-header-subtitle">
              Live highlight of the latest SwiftIOC collection run: quick filters,
              source breakdowns, and export options.
            </p>
          </div>
        </div>
      </header>

      <section
        class="status-banner"
        data-site-status-root
        aria-label="Collection status"
      >
        <div class="status-badge" data-site-status-badge>
          <span class="status-dot"></span>
          <span class="status-label" data-site-status-label>Checking feed…</span>
        </div>
        <div class="status-meta">
          <div>
            <span class="status-meta-label">Generated:</span>
            <span class="status-meta-value" data-site-generated>—</span>
          </div>
          <div>
            <span class="status-meta-label">Updated:</span>
            <span class="status-meta-value" data-site-updated>—</span>
          </div>
          <div>
            <span class="status-meta-label">Window:</span>
            <span class="status-meta-value" data-site-window>—</span>
          </div>
        </div>
      </section>

      <section class="metrics-strip" aria-label="Top metrics">
        <article class="metric-card">
          <p class="metric-label">Generated at</p>
          <p class="metric-value" data-stat="generated-at">—</p>
          <p class="metric-caption">Timestamp of this IOC bundle</p>
        </article>

        <article class="metric-card">
          <p class="metric-label">Total indicators</p>
          <p class="metric-value" data-stat="total-indicators">—</p>
          <p class="metric-caption">After duplicate removal</p>
        </article>

        <article class="metric-card">
          <p class="metric-label">Active sources</p>
          <p class="metric-value" data-stat="active-sources">—</p>
          <p class="metric-caption" data-stat="feeds-online">
            Sources active in this run
          </p>
        </article>

        <article class="metric-card">
          <p class="metric-label">Types observed</p>
          <p class="metric-value" data-stat="indicator-types">—</p>
          <p class="metric-caption">IPs, domains, hashes, URLs, …</p>
        </article>
      </section>

      <main class="dashboard-main">
        <section
          id="live-preview"
          class="panel"
          aria-labelledby="live-preview-heading"
        >
          <div class="panel-header">
            <div>
              <h2 id="live-preview-heading" class="panel-title">
                Live IOC preview
              </h2>
              <p class="panel-subtitle">
                Filter and search the latest SwiftIOC feed.
              </p>
            </div>
            <button
              type="button"
              class="panel-header-link"
              data-preview-refresh
              aria-label="Refresh IOC preview"
            >
              Refresh
            </button>
          </div>

          <div
            class="panel-body preview-panel"
            data-preview-container
            role="region"
            aria-live="polite"
            aria-busy="false"
          >
            <div class="preview-toolbar">
              <div class="toolbar-controls">
                <label class="toolbar-group" for="preview-filter">
                  <span>Type</span>
                  <select id="preview-filter" data-preview-filter disabled>
                    <option value="all">All types</option>
                  </select>
                </label>

                <label class="toolbar-group" for="preview-tag-filter">
                  <span>Tag</span>
                  <select
                    id="preview-tag-filter"
                    data-preview-tag-filter
                    disabled
                  >
                    <option value="all">All tags</option>
                  </select>
                </label>

                <label class="toolbar-group" for="preview-limit">
                  <span>Rows</span>
                  <select id="preview-limit" data-preview-limit>
                    <option value="12">12</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                  </select>
                </label>
              </div>

              <div class="toolbar-actions">
                <label class="toolbar-group" for="preview-search">
                  <span class="sr-only">Search indicators</span>
                  <input
                    id="preview-search"
                    type="search"
                    inputmode="search"
                    placeholder="Search indicator, source, or tag…"
                    data-preview-search
                    autocomplete="off"
                  />
                </label>
              </div>
            </div>

            <div class="preview-table-wrapper">
              <table
                class="preview-table"
                data-preview-table
                hidden
                aria-label="Live indicators table"
              >
                <thead>
                  <tr>
                    <th scope="col">Indicator</th>
                    <th scope="col">Type</th>
                    <th scope="col">Source</th>
                    <th scope="col">First seen</th>
                    <th scope="col">Confidence</th>
                  </tr>
                </thead>
                <tbody data-preview-body></tbody>
              </table>
            </div>

            <div
              class="preview-summary"
              data-preview-summary
              hidden
              aria-live="polite"
            >
              <div class="preview-summary-main">
                <span class="preview-summary-figure">
                  <span data-preview-visible>0</span>/<span
                    data-preview-total
                    >0</span
                  >
                  highlighted
                </span>
                <span class="preview-summary-pill">
                  <span data-preview-high>0</span> high-confidence
                  (<span data-preview-high-percent>0%</span>)
                </span>
                <span class="preview-summary-pill">
                  Top tag:
                  <span class="preview-summary-tag" data-preview-top-tag>—</span>
                  (<span data-preview-top-tag-count>0</span>)
                </span>
              </div>
              <div class="preview-summary-meta" data-preview-meta>
                <span class="preview-summary-pill">
                  Source pool: <span data-preview-pool>—</span>
                </span>
                <span class="preview-summary-pill">
                  Origin: <span data-preview-origin>—</span>
                </span>
                <span class="preview-summary-pill">
                  Refreshed: <span data-preview-refreshed>—</span>
                  <span data-preview-relative></span>
                </span>
                <span class="preview-summary-pill">
                  Window:
                  <span data-preview-window>
                    <span data-preview-oldest>—</span> →&nbsp;<span
                      data-preview-newest
                      >—</span
                    >
                    (<span data-preview-oldest-relative>—</span> /
                    <span data-preview-newest-relative>—</span>)
                  </span>
                </span>
              </div>
            </div>

            <p class="preview-status" data-preview-status data-status="idle">
              Preparing live preview…
            </p>
          </div>
        </section>

        <section
          class="panel"
          id="sources"
          aria-labelledby="sources-heading"
        >
          <div class="panel-header">
            <div>
              <h2 id="sources-heading" class="panel-title">
                Sources &amp; feeds
              </h2>
              <p class="panel-subtitle">
                Active feeds and their contribution to this collection.
              </p>
            </div>
          </div>
          <div class="panel-body summary-tables">
            <div class="table-card">
              <div class="table-card-header">
                <h3>Sources</h3>
                <p>Top sources by indicator contribution.</p>
              </div>
              <table>
                <thead>
                  <tr>
                    <th scope="col">Source</th>
                    <th scope="col">Indicators</th>
                    <th scope="col">Share</th>
                  </tr>
                </thead>
                <tbody data-table="sources"></tbody>
              </table>
              <div class="table-card-actions">
                <button
                  type="button"
                  class="button ghost"
                  data-table-toggle="sources"
                  aria-expanded="false"
                >
                  Show all sources
                </button>
                <p class="table-card-hint">
                  On phones we only show the top entries. Expand to browse the full
                  list without endless scrolling.
                </p>
              </div>
            </div>

            <div
              class="table-card"
              id="indicator-types"
              aria-labelledby="indicator-types-heading"
            >
              <div class="table-card-header">
                <h3 id="indicator-types-heading">Types</h3>
                <p>Indicator types observed in this IOC bundle.</p>
              </div>
              <table>
                <thead>
                  <tr>
                    <th scope="col">Type</th>
                    <th scope="col">Count</th>
                    <th scope="col">Share</th>
                  </tr>
                </thead>
                <tbody data-table="types"></tbody>
              </table>
              <div class="table-card-actions">
                <button
                  type="button"
                  class="button ghost"
                  data-table-toggle="types"
                  aria-expanded="false"
                >
                  Show all types
                </button>
                <p class="table-card-hint">
                  Expand for the full breakdown when you want the detailed view.
                </p>
              </div>
            </div>

            <div
              class="table-card"
              id="tags"
              aria-labelledby="tags-heading"
            >
              <div class="table-card-header">
                <h3 id="tags-heading">Tags</h3>
                <p>Top tags across the full indicator set.</p>
              </div>
              <table>
                <thead>
                  <tr>
                    <th scope="col">Tag</th>
                    <th scope="col">Count</th>
                    <th scope="col">Share</th>
                  </tr>
                </thead>
                <tbody data-table="tags"></tbody>
              </table>
              <div class="table-card-actions">
                <button
                  type="button"
                  class="button ghost"
                  data-table-toggle="tags"
                  aria-expanded="false"
                >
                  Show all tags
                </button>
                <p class="table-card-hint">
                  Open the full tag list in-place instead of scrolling through an
                  endless stack on smaller screens.
                </p>
              </div>
            </div>
          </div>
        </section>
      </main>

      <section
        id="exports"
        class="panel"
        aria-labelledby="exports-heading"
      >
        <div class="panel-header">
          <div>
            <h2 id="exports-heading" class="panel-title">
              Exports &amp; raw feeds
            </h2>
            <p class="panel-subtitle">
              Download the same SwiftIOC bundle in your preferred format.
            </p>
          </div>
        </div>
        <div class="panel-body">
          <div class="exports-grid">
            <a
              class="button-link"
              href="iocs/latest.csv"
              rel="nofollow"
              download
              >CSV</a
            >
            <a
              class="button-link"
              href="iocs/latest.tsv"
              rel="nofollow"
              download
              >TSV</a
            >
            <a
              class="button-link"
              href="iocs/latest.json"
              rel="nofollow"
              download
              >JSON</a
            >
            <a
              class="button-link"
              href="iocs/latest.jsonl"
              rel="nofollow"
              download
              >JSONL</a
            >
            <a
              class="button-link"
              href="iocs/stix2.json"
              rel="nofollow"
              download
              >STIX 2.1 bundle</a
            >
          </div>
          <p class="panel-footnote">
            These files are generated by the same SwiftIOC collector run that
            powers the live dashboard above.
          </p>
        </div>
      </section>
    </div>

    <script defer src="assets/dashboard.js"></script>
  </body>
</html>
